# 网络通信

[TOC]

# TCP和UDP有什么区别？TCP为什么是三次握手，而不是两次？

**TCP**它是一种面向连接的、可靠的、传输层通信协议。（Transfer Control protocol）

特点：好比是打电话：面向连接的，点对点的通信，高可靠的，效率比较低，占用的系统资源比较多。



**UDP**是一种无连接的、不可靠的、传输层通信协议(User Datagram Protocol)

特点：好比是广播：不需要连接，发送方不管接收方有没有准备好，直接发消息；可进行广播发送；传输不可靠，有可能丢失消息；效率比较高；协议比较简单，占用的系统资源就比较少。



TCP建立连接**三次握手**。

1）第一次握手：建立连接时，客户端A发送SYN包（SYN=j）到服务器B，并进入SYN_SEND状态，等待服务器B确认。

（2）第二次握手：服务器B收到SYN包，必须确认客户A的SYN（ACK=j+1），同时自己也发送一个SYN包（SYN=k），即SYN+ACK包，此时服务器B进入SYN_RECV状态。

（3）第三次握手：客户端A收到服务器B的SYN＋ACK包，向服务器B发送确认包ACK（ACK=k+1），此包发送完毕，客户端A和服务器B进入ESTABLISHED状态，完成三次握手。

完成三次握手，客户端与服务器开始传送数据。



断开连接**四次挥手**

（1）客户端A发送一个FIN，用来关闭客户A到服务器B的数据传送。

（2）服务器B收到这个FIN，它发回一个ACK，确认序号为收到的序号加1。和SYN一样，一个FIN将占用一个序号。

（3）服务器B关闭与客户端A的连接，发送一个FIN给客户端A。

（4）客户端A发回ACK报文确认，并将确认序号设置为收到序号加1。





如果是两次握手：

C->S

S->C

如果C发了消息，很长时间没有收到，则会认为请求被拒绝，则会去干别的事情（不会占用客户端太久时间）。但是对于S其实已经发了消息，则会认为通道已经建立，而一直等着请求（连接还不会中断，造成资源浪费）。



## 为什么建立连接是三次握手，而关闭连接却是四次挥手呢？

这是因为服务端在LISTEN状态下，收到建立连接请求的SYN报文后，把ACK和SYN放在一个报文里发送给客户端。而关闭连接时，当收到对方的FIN报文时，仅仅表示对方不再发送数据了但是还能接收数据，己方是否现在关闭发送数据通道，需要上层应用来决定，因此，己方ACK和FIN一般都会分开发送。



# Java有哪几种IO模型？有什么区别？

## BIO同步阻塞IO

同步可靠性差，吞吐量低，适用于连接比较少，且比较固定的场景。JDK1.4之前唯一的选择。

## NIO同步非阻塞IO

可靠性比较好，吞吐量比较高，适用于连接比较多并且连接比较短（轻操作），例如聊天室。JDK1.4开始。编程模型最复杂。

## AIO异步非阻塞IO

可靠性是最好的，吞吐量也是非常高的。适用于连接比较多，并且连接比较长（重操作）。例如相册服务器。JDK7版本之后才开始用。编程模型相对来说比较简单，需要操作系统来支持。



同步、异步和阻塞、非阻塞

在一个网络中客户端会发一个请求到服务端。

1. 客户端发送了请求后，就一直在等着服务器响应。客户端：阻塞。请求：同步。
2. 客户端发了请求后，就去干别的事情了。时不时的过来检查服务端是否给出了响应。客户端：非阻塞。请求：同步。
3. 换异步请求。客户端发了请求后，就坐在椅子上，等着服务端返回响应。客户端：阻塞。请求：异步。
4. 客户端发了请求后，就去干别的事情了。等到服务端给出响应后，再过来处理业务逻辑。客户端：非阻塞 。请求：异步。



# Java NIO的几个核心组件是什么？分别有什么用？



# select， poll和epoll有什么区别？



# 描述一下HTTP和HTTPS的区别?

HTTP: 是互联网上应用最为广泛的一种网络通信协议，基于TCP协议，可以使浏览器工作更为高效，减少网络传输。

HTTPS：是HTTP的加强版，可以认为是HTTP+SSL（Secure Socket Layer）。在HTTP的基础上增加了一系列的安全机制。一方面保证数据传输安全，另一位方面访问者增加了验证机制。是目前现行架构下，最为安全的解决方案。

主要区别：

1. HTTP的连接是简单无状态的，HTTPS的数据传输是经过证书加密的，安全性更高。
2. HTTP是免费的。而HTTPS需要申请证书，而证书通常是需要收费的，并且费用一般不低。
3. 他们的传输协议不同，所以他们使用的端口是不一样的，HTTP默认是80端口，而HTTPS默认是443端口。

HTTPS的缺点：

1. HTTPS的握手协议比较费时，所以会影响服务的响应速度以及吞吐量。
2. HTTPS也并不是完全安全的。它的证书体系其实并不是完全安全的。并且HTTPS在面对DDOS这样的攻击时，几乎起不到任何作用。
3. 证书需要费钱，并且功能越强大的证书费用越高。





























