[TOC]

# ArrayList扩容机制

无参构造，数组容量为0。

有参构造，有多大就创建多大。



如果容量为0：

1. 添加数据->扩容为10

2. 满了，再添加->扩容1.5倍（15），拷贝元素

   (实际上扩容10>>1 = 5)

3. 满了，再添加->扩容（加15>>1=7)为22，拷贝元素



addAll(List.of(1,2,3)): 扩容成10

addAll(List.of(1,2,3...11)): 扩容成11 ->(找下一个扩容大小和添加后数据长度的最大值)



# iterator的fail-fast和fail-safe机制

## fail-fast

一旦发现遍历的同时其他人来修改，则会立刻抛出异常

## fail-safe

发现遍历的同时其他人来修改，应当能有应对策略，例如牺牲一致性来让整个遍历运行完成。



